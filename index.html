<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ISBN Library</title>
<style>
body{background:#2C2F33;color:#FFF;font-family:Helvetica,Arial,sans-serif;margin:0;padding:0;}
.container{max-width:1200px;margin:0 auto;padding:20px;}
h1{text-align:center;color:#7289DA;margin-top:10px;}
#searchInput { width: 60%; margin: 12px auto; display: block; padding: 10px; font-size: 14px; border-radius: 6px; border: 1px solid #444; background: #23272A; color: #FFF;}
.grid{display:flex;flex-wrap:wrap;justify-content:center;gap:20px;padding:20px;}
.card{background:#23272A;width:150px;border-radius:8px;overflow:hidden;text-align:center;transition: transform 0.12s;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,0.4);}
.card:hover{transform: scale(1.05);}
.card img{width:150px;height:220px;object-fit:cover;display:block;margin:0 auto;background:#ddd;}
.card .title{font-weight:bold;margin:6px 8px;font-size:13px;min-height:36px;}
.card .meta{font-size:11px;margin:2px;color:#BBB;padding-bottom:8px;}
</style>
<script>
function searchLibrary() {
    let input = document.getElementById('searchInput').value.toLowerCase();
    let cards = document.getElementsByClassName('card');
    for (let i=0;i<cards.length;i++){
        let card = cards[i];
        let text = card.innerText.toLowerCase();
        card.style.display = text.includes(input) ? '' : 'none';
    }
}

// Dynamically load books from lib.json
async function loadBooks() {
    try {
        const res = await fetch('lib.json');
        const books = await res.json();
        books.sort((a,b) => {
            const seriesA = (a.Title||'').replace(/,?\s*Vol\.?\s*\d+/,'').toLowerCase();
            const seriesB = (b.Title||'').replace(/,?\s*Vol\.?\s*\d+/,'').toLowerCase();
            const volA = parseInt((a.Title||'').match(/Vol\.? (\d+)/)?.[1] || 0);
            const volB = parseInt((b.Title||'').match(/Vol\.? (\d+)/)?.[1] || 0);
            return seriesA.localeCompare(seriesB) || volA - volB;
        });
        const grid = document.getElementById('bookGrid');
        books.forEach(b => {
            const card = document.createElement('div');
            card.className = 'card';
            card.title = b.Title || '';
            card.innerHTML = `
                <img src="${b.Cover||'https://via.placeholder.com/150x220?text=No+Cover'}" onclick="window.open('${b.Cover||''}','_blank')">
                <div class="title">${b.Title||''}</div>
                <div class="meta">
                    ${(b.Authors||'')}<br>
                    ${(b.Publisher||'')}<br>
                    ${(b.Date||'')}<br>
                    ${(b.ISBN||'')}
                </div>`;
            grid.appendChild(card);
        });
    } catch (err) {
        console.error('Failed to load books:', err);
    }
}

window.onload = loadBooks;
</script>
</head>
<body>
<div class="container">
<h1>ISBN Library</h1>
<input type="text" id="searchInput" onkeyup="searchLibrary()" placeholder="Search by title, author, publisher, ISBN...">
<div class="grid" id="bookGrid"></div>
</div>
</body>
</html>
